import{s as e,i as t,a as n,d as s,c as r,b as c,e as o,f as p,g as l,A as i,P as a,h as u,C as h,D as d,S as f,j as m}from"../shared.min2.js";import{p as $,X as g,i as x,J as y}from"../shared.min.js";const E=/(?:<!--[\S\s]*?-->|<(?:"[^"]*"['"]*|'[^']*'['"]*|[^'">])+>)/g,b=/(?:\s(?<boolean>[^/\s><=]+?)(?=[\s/>]))|(?:(?<name>\S+?)(?:\s*=\s*(?:(['"])(?<quotedValue>[\s\S]*?)\3|(?<unquotedValue>[^\s>]+))))/g,v={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,menuitem:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0};function j(e,t,n){const s=t.indexOf("<",n),r=t.slice(n,-1===s?void 0:s);/^\s*$/.test(r)||e.push({type:"text",content:r})}function C(e,t){const n=t.replace("\x3c!--","").replace("--\x3e","");/^\s*$/.test(n)||e.push({type:"comment",content:n})}function w(e){const t=[];let n,s=-1;const r=[],c={};return e.replace(E,((o,p)=>{const l="/"!==o.charAt(1),i="\x3c!--"===o.slice(0,4),a=p+o.length,u=e.charAt(a);let h;l&&!i&&(s++,n=function(e){const t={type:"tag",name:"",voidElement:!1,attrs:{},children:[]},n=e.match(/<\/?([^\s]+?)[/\s>]/);if(n&&(t.name=n[1],(v[n[1].toLowerCase()]||"/"===e.charAt(e.length-2))&&(t.voidElement=!0),t.name.startsWith("!--"))){const t=e.indexOf("--\x3e");return{type:"comment",comment:-1!==t?e.slice(4,t):""}}const s=new RegExp(b);for(const n of e.matchAll(s))t.attrs[n[1]||n[2]]=n[4]||n[5]||"";return t}(o),!n.voidElement&&u&&"<"!==u&&j(n.children,e,a),c[n.tagName]=n,0===s&&t.push(n),h=r[s-1],h&&h.children.push(n),r[s]=n),i&&C(s<0?t:r[s].children,o),(i||!l||n.voidElement)&&(i||s--,"<"!==u&&u&&(h=-1===s?t:r[s].children,j(h,e,a)))})),t}function A(e,t){switch(t.type){case"text":return e+t.content;case"tag":return e+="<"+t.name+(t.attrs?function(e){const t=[];for(const n in e)t.push(n+'="'+e[n].replace(/"/g,"&quot;")+'"');return t.length?" "+t.join(" "):""}(t.attrs):"")+(t.voidElement?"/>":">"),t.voidElement?e:e+t.children.reduce(A,"")+"</"+t.name+">";case"comment":return e+"\x3c!--"+t.content+"--\x3e"}}const P=new Map,S=/^(?:area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr)$/i,_=" \\f\\n\\r\\t",O="[^ "+_+"\\/>\"'=]+",N="[ "+_+"]+"+O,k="<([A-Za-z$#]+[A-Za-z0-9:_-]*)((?:",I="(?:\\s*=\\s*(?:'[^']*?'|\"[^\"]*?\"|\\([^)]*?\\)|<[^>]*?>|"+O+"))?)",L=new RegExp(k+N+I+"+)([ "+_+"]*/?>)","g"),V=new RegExp("("+N+"\\s*=\\s*)(\x3c!--#--\x3e|['\"(]([\\w\\s]*\x3c!--#--\x3e[\\w\\s]*)*['\")])","gi"),W=new RegExp(k+N+I+"*)([ "+_+"]*/>)","g"),q="\x3c!--#--\x3e",D=new Set(["class","on","oncapture","style","use","prop","attr"]);function G(e,t,n,s){return"<"+t+n.replace(V,R)+s}function R(e,t,n){return t+('"'===n[0]||"'"===n[0]?n.replace(/<!--#-->/g,"###"):'"###"')}function z(e,t,n){return S.test(t)?e:"<"+t+n+"></"+t+">"}var M=function(e,{delegateEvents:t=!0}={}){let n=1;function s(t){let s=0,r="";for(;s<t.length-1;s++)r=r+t[s]+"\x3c!--#--\x3e";r+=t[s],r=r.replace(W,z).replace(/<(<!--#-->)/g,"<###").replace(/\.\.\.(<!--#-->)/g,"###").replace(L,G).replace(/>\n+\s*/g,">").replace(/\n+\s*</g,"<").replace(/\s+</g," <").replace(/>\s+/g,"> ");const[c,l]=function(t){const s={path:"",decl:[],exprs:[],delegatedEvents:new Set,counter:0,first:!0,multi:!1,templateId:0,templateNodes:[]},r=n,c=t;let l;t.length>1&&(t=[{type:"fragment",children:t}]);"###"===t[0].name?(l=!0,o(t[0],s)):p(t[0],s);e.delegateEvents(Array.from(s.delegatedEvents));return[[c].concat(s.templateNodes).map((e=>e.reduce((function(e,t){return e+A("",t)}),""))),new Function("tmpls","exprs","r",s.decl.join(",\n")+";\n"+s.exprs.join(";\n")+(l?"":`;\nreturn _$el${r};\n`))]}(w(r)),i=[];for(let e=0;e<c.length;e++){i.push(document.createElement("template")),i[e].innerHTML=c[e];const t=i[e].content.querySelectorAll("script,style");for(let n=0;n<t.length;n++){const s=t[n].firstChild?.data||"";if(s.indexOf(q)>-1){const n=s.split(q).reduce(((e,t,n)=>(n&&e.push(""),e.push(t),e)),[]);t[e].firstChild.replaceWith(...n)}}}return i[0].create=l,P.set(t,i),i}function r(s,r,c,o,p,l){if("on"===r.slice(0,2))if(r.includes(":")){let e=r.startsWith("oncapture:");l.exprs.push(`${s}.addEventListener("${r.slice(e?10:3)}",exprs[${l.counter++}]${e?",true":""})`)}else{const n=r.slice(2).toLowerCase(),c=t&&e.DelegatedEvents.has(n);l.exprs.push(`r.addEventListener(${s},"${n}",exprs[${l.counter++}],${c})`),c&&l.delegatedEvents.add(n)}else if("ref"===r)l.exprs.push(`exprs[${l.counter++}](${s})`);else{const t=Object.assign({},l,{exprs:[]}),i=l.counter;if(function(t,s,r,c,o,p){let l,i,a="###"===r?`!doNotWrap ? exprs[${p.counter}]() : exprs[${p.counter++}]`:r.split("###").map(((e,t)=>t?` + (typeof exprs[${p.counter}] === "function" ? exprs[${p.counter}]() : exprs[${p.counter++}]) + "${e}"`:`"${e}"`)).join("");(l=s.split(":"))&&l[1]&&D.has(l[0])&&(s=l[1],i=l[0]);const u=e.ChildProperties.has(s),h=e.Properties.has(s);if("style"===s){const e="_$v"+n++;p.decl.push(`${e}={}`),p.exprs.push(`r.style(${t},${a},${e})`)}else if("classList"===s){const e="_$v"+n++;p.decl.push(`${e}={}`),p.exprs.push(`r.classList(${t},${a},${e})`)}else if("attr"!==i&&(u||!c&&(e.PropAliases[s]||h)||o||"prop"===i))!o||u||h||"prop"===i||(s=function(e){return e.toLowerCase().replace(/-([a-z])/g,((e,t)=>t.toUpperCase()))}(s)),p.exprs.push(`${t}.${e.PropAliases[s]||s} = ${a}`);else{const n=c&&s.indexOf(":")>-1&&e.SVGNamespace[s.split(":")[0]];n?p.exprs.push(`r.setAttributeNS(${t},"${n}","${s}",${a})`):p.exprs.push(`r.setAttribute(${t},"${e.Aliases[s]||s}",${a})`)}}(s,r,c,o,p,t),l.decl.push(`_fn${i} = (${"###"===c?"doNotWrap":""}) => {\n${t.exprs.join(";\n")};\n}`),"###"===c)l.exprs.push(`typeof exprs[${i}] === "function" ? r.effect(_fn${i}) : _fn${i}(true)`);else{let e="";for(let n=i;n<t.counter;n++)n!==i&&(e+=" || "),e+=`typeof exprs[${n}] === "function"`;l.exprs.push(e+` ? r.effect(_fn${i}) : _fn${i}()`)}l.counter=t.counter,l.wrap=!1}}function c(e){let t=[];for(const n of e)if(Array.isArray(n)){if(!n.length)continue;t.push(`r.wrapProps({${n.join(",")||""}})`)}else t.push(n);return t.length>1?`r.mergeProps(${t.join(",")})`:t[0]}function o(e,t){let s=[];const r=Object.keys(e.attrs),o=[s],l=t.counter++;for(let n=0;n<r.length;n++){const c=r[n],p=e.attrs[c];"###"===c?(o.push(`exprs[${t.counter++}]`),o.push(s=[])):"###"===p?s.push(`${c}: exprs[${t.counter++}]`):s.push(`${c}: "${p}"`)}if(1===e.children.length&&"comment"===e.children[0].type&&"#"===e.children[0].content)s.push(`children: () => exprs[${t.counter++}]`);else if(e.children.length){const n={type:"fragment",children:e.children},r=Object.assign({},t,{first:!0,decl:[],exprs:[],parent:!1});p(n,r),s.push(`children: () => { ${r.exprs.join(";\n")}}`),t.templateId=r.templateId,t.counter=r.counter}let i;t.multi&&(i="_$el"+n++,t.decl.push(`${i} = ${t.path}.${t.first?"firstChild":"nextSibling"}`)),t.parent?t.exprs.push(`r.insert(${t.parent}, r.createComponent(exprs[${l}],${c(o)})${i?`, ${i}`:""})`):t.exprs.push(`${t.fragment?"":"return "}r.createComponent(exprs[${l}],${c(o)})`),t.path=i,t.first=!1}function p(t,s){if("fragment"===t.type){const e=[];t.children.forEach((t=>{if("tag"===t.type){if("###"===t.name){const n=Object.assign({},s,{first:!0,fragment:!0,decl:[],exprs:[]});return o(t,n),e.push(n.exprs[0]),s.counter=n.counter,void(s.templateId=n.templateId)}s.templateId++;const r=n,c=Object.assign({},s,{first:!0,decl:[],exprs:[]});s.templateNodes.push([t]),p(t,c),e.push(`function() { ${c.decl.join(",\n")+";\n"+c.exprs.join(";\n")+`;\nreturn _$el${r};\n`}}()`),s.counter=c.counter,s.templateId=c.templateId}else"text"===t.type?e.push(`"${t.content}"`):"comment"===t.type&&"#"===t.content&&e.push(`exprs[${s.counter++}]`)})),s.exprs.push(`return [${e.join(", \n")}]`)}else if("tag"===t.type){const c="_$el"+n++,l=!s.decl.length,i=s.templateId;s.decl.push(l?"":`${c} = ${s.path}.${s.first?"firstChild":"nextSibling"}`);const a=Object.keys(t.attrs),u=e.SVGElements.has(t.name),h=t.name.includes("-");if(s.hasCustomElement=h,a.includes("###")){const e=[];let n="";for(let r=0;r<a.length;r++){const c=a[r];if(t.attrs[c].includes("###")){let e=s.counter++;n+=`${c}: ${"ref"!==c?`typeof exprs[${e}] === "function" ? exprs[${e}]() : `:""}exprs[${e}],`,delete t.attrs[c]}else"###"===c&&(n.length&&(e.push(`()=>({${n}})`),n=""),e.push(`exprs[${s.counter++}]`),delete t.attrs[c])}n.length&&e.push(`()=>({${n}})`),s.exprs.push(`r.spread(${c},${1===e.length?`typeof ${e[0]} === "function" ? r.mergeProps(${e[0]}) : ${e[0]}`:`r.mergeProps(${e.join(",")})`},${u},${!!t.children.length})`)}else for(let e=0;e<a.length;e++){const n=a[e],o=t.attrs[n];o.includes("###")&&(delete t.attrs[n],r(c,n,o,u,h,s))}s.path=c,s.first=!1,function(e,t){const n=Object.assign({},t,{first:!0,multi:!1,parent:t.path});if(e.children.length>1)for(let t=0;t<e.children.length;t++){const s=e.children[t];if("comment"===s.type&&"#"===s.content||"tag"===s.type&&"###"===s.name){n.multi=!0;break}}let s=0;for(;s<e.children.length;){const t=e.children[s];"###"!==t.name?(p(t,n),s++):(n.multi?(e.children[s]={type:"comment",content:"#"},s++):e.children.splice(s,1),o(t,n))}t.counter=n.counter,t.templateId=n.templateId,t.hasCustomElement=t.hasCustomElement||n.hasCustomElement}(t,s),l&&(s.decl[0]=s.hasCustomElement?`const ${c} = r.untrack(() => document.importNode(tmpls[${i}].content.firstChild, true))`:`const ${c} = tmpls[${i}].content.firstChild.cloneNode(true)`)}else if("text"===t.type){const e="_$el"+n++;s.decl.push(`${e} = ${s.path}.${s.first?"firstChild":"nextSibling"}`),s.path=e,s.first=!1}else if("comment"===t.type){const e="_$el"+n++;s.decl.push(`${e} = ${s.path}.${s.first?"firstChild":"nextSibling"}`),"#"===t.content&&(s.multi?s.exprs.push(`r.insert(${s.parent}, exprs[${s.counter++}], ${e})`):s.exprs.push(`r.insert(${s.parent}, exprs[${s.counter++}])`)),s.path=e,s.first=!1}}return e.wrapProps=t=>{const n=Object.getOwnPropertyDescriptors(t);for(const s in n)"function"!=typeof n[s].value||n[s].value.length||e.dynamicProperty(t,s);return t},function(t,...n){const r=P.get(t)||s(t);return r[0].create(r,n,e)}}({effect:$,style:e,insert:t,untrack:g,spread:n,createComponent:x,delegateEvents:s,classList:r,mergeProps:y,dynamicProperty:c,setAttribute:o,setAttributeNS:p,addEventListener:l,Aliases:i,PropAliases:a,Properties:u,ChildProperties:h,DelegatedEvents:d,SVGElements:f,SVGNamespace:m}),Z=M;export{Z as default};
